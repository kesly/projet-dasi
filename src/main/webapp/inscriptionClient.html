<!DOCTYPE html>
<!--
To change this license header, choose License Headers in Project Properties.
To change this template file, choose Tools | Templates
and open the template in the editor.
-->
<html>
    <head>
        <title>Predict'IF</title>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
    </head>
    <body>
        <div>
            <h1>Inscription</h1>
        </div>
        <div>
            <form>
                <div>
                  <label for="nom">Nom </label>
                  <input type="text" name="nom" id="nom" required>
                </div>
                <div>
                  <label for="prenom">Prénom </label>
                  <input type="text" name="prenom" id="prenom" required>
                </div>
                <div>
                  <label for="datenaissance">Date de naissance </label>
                  <input type="date" name="datenaissance" id="datenaissance" required>
                </div>
                <div>
                  <label for="adressepostale">Adresse Postale </label>
                  <input type="text" name="adressepostale" id="adressepostale" required>
                </div>
                <div>
                  <label for="codepostal">Code postal </label>
                  <input type="text" name="codepostal" id="codepostal" required>
                </div>
                <div>
                  <label for="commune">Commune </label>
                  <input type="text" name="commune" id="commune" required>
                </div>  
                <div >
                  <label for="email">Email </label>
                  <input type="email" name="email" id="email" required>
                </div>
                <div>
                  <label for="telephone">Téléphone </label>
                  <input type="text" name="telephone" id="telephone" required>
                </div>
                <div>
                  <label for="mdp">Mot de passe </label>
                  <input type="password" name="mdp" id="mdp" required>
                </div>
                <div>
                  <label for="cmdp">Confirmer mot de passe </label>
                  <input type="password" name="cmdp" id="cmdp" required>
                </div>
                <div>
                  <input type="submit" id="boutonInscription" value="Valider">
                </div>
              </form>
        </div>
    </body>
    <script>
    $(document).ready(function () {
        $('#boutonInscription').on('click', function () { // Fonction appelée lors du clic sur le bouton

            console.log("clic sur le bouton inscription"); // LOG dans Console Javascript
            //$('#notification').html("Connexion..."); // Message pour le paragraphe de notification

            // Récupération de la valeur des champs du formulaire
            let champ_mdp = $('#mdp').val();
            let champ_cmdp = $('#cmdp').val();
            let champ_prenom = $('#prenom').val();
            let champ_nom = $('#nom').val();
            let champ_email = $('#email').val();
            let champ_telephone = $('#telephone').val();
            let champ_codePostal = $('#codePostal').val();
            let champ_adressePostale = $('#adressepostale').val();
            let champ_date = $('#datenaissance').val();
            let champ_commune = $('#commune').val();

            if(mdp.localeCompare(cmdp)!=0){
               alert('mdp différents'); 
            } else {
                // Appel AJAX
                $.ajax({
                url: './ActionServlet',
                method: 'POST',
                data: {
                    todo: 'inscriptionClient',
                    mdp : champ_mdp,
                    cmdp : champ_cmdp,
                    prenom : champ_prenom,
                    nom : champ_nom,
                    email : champ_email,
                    telephone : champ_telephone,
                    codePostal : champ_codePostal,
                    adressePostale : champ_adressePostale,
                    date : champ_date,
                    commune : champ_commune
                },
                dataType: 'json'
            })
                .done(function (response) { // Fonction appelée en cas d'appel AJAX réussi
                    console.log('Response', response); // LOG dans Console Javascript
                    if (response.connexion) {
                        //$('#notification').html("Connexion OK");  // Message pour le paragraphe de notification
                        // TODO: afficher les informations du client dans la notification
                        // Exemple: Connexion de Ada Lovelace (ID 1)
                        let client = response.client;
                        //$('#notification').html("Connexion de " + client.prenom + " " + client.nom + " (ID " + client.id + ")");  // Message pour le paragraphe de notification

                        // aller page suivante
                    } else {
                        //$('#notification').html("Erreur de Connexion"); // Message pour le paragraphe de notification
                    }
                })
                .fail(function (error) { // Fonction appelée en cas d'erreur lors de l'appel AJAX
                    console.log('Error', error); // LOG dans Console Javascript
                    alert("Erreur lors de l'appel AJAX");
                })
                .always(function () { // Fonction toujours appelée

                });
            }
            
            
            });
        });
    </script>
</html>
